<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>手机工坊</title>
	<link rel="stylesheet" href="/myfirstwork/css/base.css">
	<link rel="stylesheet" href="/myfirstwork/css/reset.css">
	<link rel="stylesheet" href="/myfirstwork/css/product.css">
	<script src="/myfirstwork/js/jquery-1.12.4.min.js"></script>
	<script src="/myfirstwork/js/index.js"></script>
	<script src="/myfirstwork/js/jquery.cookie.js"></script>
</head>
<body>
	<!-- 头部 -->
	<div class="container top" id="header"></div>
	


	<!-- 导航 -->
	<div class="nav-wrap" id="nav"></div>



	<!-- 面包屑导航 -->
	<ul class="container breadcrumb">
		<li>您当前的位置：&nbsp;</li>
		<li><a href="/myfirstwork/index.html">首页</a><span class="divider">>></span></li>
		<li><a href="/myfirstwork/html/products.html">工坊商城</a><span class="divider">>></span></li>
		<li>商品详情</li>
	</ul>



	<!-- 商品详情 -->
	<div class="content container clr">
		<div class="content_left l">
			<div class="goods_detail clr">
				<div class="bigimg l" id="small">
					<img src="/myfirstwork/imgs/big/1.jpg" id="spic">
					<div id="len"></div>
				</div>
				<div id="big">
					<img src="/myfirstwork/imgs/big/1.jpg" alt="" id="bigpic">
				</div>
				<form id="form_cart">
					<div class="goods_txt">
						<div class="goods_name">魅族 MX4 pro 保护壳-猫头鹰</div>
						<div class="goods_price">
							<dl class="unit">
								<dt>价　格：</dt>
								<dd class="oldprice">￥99.00</dd>
							</dl>
							<dl class="unit price">
								<dd>
									￥
									<span class="bigprice">49.00</span>
									<span class="tip">包邮</span>
								</dd>
							</dl>
						</div>
						<div class="goods_feature">
							<dl class="unit">
								<dt>商品编号：</dt>
								<dd>423-A127649</dd>
							</dl>
							<dl class="unit">
								<dt>适用型号：</dt>
								<dd>魅族 MX4 PRO 保护壳</dd>
							</dl>
							<dl class="unit">
								<dt>商品类型：</dt>
								<dd>保护壳</dd>
							</dl>
							<dl class="unit">
								<dt>工　艺：</dt>
								<dd>
									<span class="co1">彩绘</span>
								</dd>
							</dl>
						</div>
						<div class="goods_count">
							<dl class="unit">
								<dt>件　数：</dt>
								<dd>
									<div class="count">
										<div class="control" id="quantitybox"><a href="javascript:;" class="minus">-</a><input type="text" maxlength="3" value="1" id="total" class="quantity"><a href="javascript:;" class="plus">+</a></div>
										<span>件</span>
									</div>
								</dd>
							</dl>
						</div>
						<div class="goods_otherbtn">
							<a href="javascript:;" class="btn">立即定制</a>
							<a href="javascript:;" class="addcart" id="addbtn">
								<i></i>
								加入购物车
							</a>
						</div>
					</div>
				</form>
			</div>
			<div class="productdetail">
				<div class="tabsbox">
					<ul class="goodtabs clr">
						<li>
							<a href="javascript:;" class="active">商品详情</a>
						</li>
					</ul>
				</div>
				<div class="detailbox">
					<div class="iframebox">
						<img src="/myfirstwork/imgs/iframe.jpg" alt="">
					</div>
					<div class="iframebox">
						<img src="/myfirstwork/imgs/iframe2.jpg" alt="">
					</div>
				</div>
			</div>
		</div>
		<div class="content_right l">
			<div class="hotgoodslist">
				<div class="boxtitle">同机型热卖</div>
				<div class="hotgoodsitem">
					<dt class="hotimg">
						<a href="javascript:;"><img src="/myfirstwork/imgs/hot/5.jpg" alt="" width="160" height="160"></a>
					</dt>
					<dd class="hotgname">乐趣无穷</dd>
					<dd class="price">
						￥
						<span class="newprice">49.00</span>
					</dd>
				</div>
				<div class="hotgoodsitem">
					<dt class="hotimg">
						<a href="javascript:;"><img src="/myfirstwork/imgs/hot/6.jpg" alt="" width="160" height="160"></a>
					</dt>
					<dd class="hotgname">荷塘月色</dd>
					<dd class="price">
						￥
						<span class="newprice">49.00</span>
					</dd>
				</div>
				<div class="hotgoodsitem">
					<dt class="hotimg">
						<a href="javascript:;"><img src="/myfirstwork/imgs/hot/7.jpg" alt="" width="160" height="160"></a>
					</dt>
					<dd class="hotgname">万圣节</dd>
					<dd class="price">
						￥
						<span class="newprice">49.00</span>
					</dd>
				</div>
				<div class="hotgoodsitem">
					<dt class="hotimg">
						<a href="javascript:;"><img src="/myfirstwork/imgs/hot/8.jpg" alt="" width="160" height="160"></a>
					</dt>
					<dd class="hotgname">小兔娘子</dd>
					<dd class="price">
						￥
						<span class="newprice">49.00</span>
					</dd>
				</div>
				<div class="hotgoodsitem">
					<dt class="hotimg">
						<a href="javascript:;"><img src="/myfirstwork/imgs/hot/10.jpg" alt="" width="160" height="160"></a>
					</dt>
					<dd class="hotgname">两只小猫</dd>
					<dd class="price">
						￥
						<span class="newprice">49.00</span>
					</dd>
				</div>
				<div class="hotgoodsitem">
					<dt class="hotimg">
						<a href="javascript:;"><img src="/myfirstwork/imgs/hot/14.jpg" alt="" width="160" height="160"></a>
					</dt>
					<dd class="hotgname">小卡哇伊</dd>
					<dd class="price">
						￥
						<span class="newprice">49.00</span>
					</dd>
				</div>
			</div>
		</div>
	</div>
	




	
	<!-- footer -->
	<div class="footer container" id="footer"></div>

	<script>
		$('#footer').load('/myfirstwork/html/base/footer.html');
		$('#nav').load('/myfirstwork/html/base/nav.html');

		$.ajax('/myfirstwork/html/base/header.html').done(function  (data) {
			$.cookie.json = true;
			var user = $.cookie('loginuser') || {};
			if($.isEmptyObject(user)){
				$(data).appendTo('#header');
			}else{
				$(data).appendTo('#header').find('#login').html('<span>Hi,<a href="#" style="padding:0;font-weight:bold">[ '+user.username+' ]</a></span><em>|</em><a href="javascript:;" id="eixt">退出</a>');
				$('#eixt').click(function  () {
					$.cookie.json = true;
					$.cookie('loginuser',null,{expires:-7, path:'/'});

					window.location = '/myfirstwork/index.html';
				})
			}

			shopcartcount ();
			
		})

		



		


		//添加到购物车
		$('#addbtn').click(function  (e) {
			var _src = '/myfirstwork/imgs/hot/13.jpg';

			var _price = 49;

			var _name = '魅族 MX4 pro 保护壳-猫头鹰';

			var _id = '416-A488546';

			var _count = parseFloat($('#total').val());

			$.cookie.json = true;

			var _products = $.cookie('products') || [];

			var index = exist(_src, _products);

			if(index === -1){
				_products.push({
					src: _src,
					name: _name,
					id: _id,
					price: _price,
					count: _count

				})
			}else{
				var numC = _products[index].count + _count;
				_products[index].count = numC;
			}

			$.cookie('products', _products, {expires:7,path:'/'});

			shopcartcount ();

			window.location = '/myfirstwork/html/shopcart.html';

			
		})

		//+按钮
		$('.plus').click(function  () {
			var n = $('#total').val();
			n++;
			$('#total').val(n);
		});

		//-按钮
		$('.minus').click(function  () {
			var n = $('#total').val();
			if(n>1){
				n--;
				$('#total').val(n);
			}
		});

		
		
		




		//放大镜
		var $Small = $('#small');
		var $Big = $('#big');
		var $Len = $('#len');
		var oSmallWidth = $Small.width();
		var oSmallHeight = $Small.height();

		var oLenWidth = $Len.width();
		var oLenHeight = $Len.height();
		var oBigWidth = $Big.width();
		var oBigHeight = $Big.height();
		var $bigpic = $('#bigpic');
		var $spic = $('#spic');

		var rateX = oSmallWidth/oLenWidth;
		var rateY = oSmallHeight/oLenHeight;

		$spic.css('width',oSmallWidth);
		$spic.css('height',oSmallHeight);

		$bigpic.css('width',oSmallWidth*rateX);
		$bigpic.css('height',oSmallHeight*rateY);

		$Small.mouseenter(function  () {
			$Len.show();
			$Big.show();
		})

		$Small.mouseleave(function  () {
			$Len.hide();
			$Big.hide();
		})

		$Small.mousemove(function  (e) {
			$Len.offset({
				top:e.pageY - oLenHeight/2,
				left:e.pageX - oLenWidth/2
			});
			
			var _left = $Len.position().left;
			var _top = $Len.position().top;

			if(_left<0){_left=0};
			if(_top<0){_top=0};
			if(_left>oSmallWidth-oLenWidth){_left=oSmallWidth-oLenWidth};
			if(_top>oSmallHeight-oLenHeight){_top=oSmallHeight-oLenHeight};

			$Len.css({left:_left,top:_top});

			$bigpic.css({left:-_left*rateX,top:-_top*rateY});
			
		})



		// 函数
		function exist (_src,arr) {
			for(var i=0;i<arr.length;i++){
				if(arr[i].src === _src){
					return i;
				}
			}
			return -1;
		}


		function shopcartcount () {
			$.cookie.json = true;

			var _products = $.cookie('products') || [];
			if(_products.length !== 0){
				var num = 0;
				$.each(_products, function  (i, ele) {
					num += ele.count;
				})

				$('#cart_num').text(num);

			}
		}

		



		
	</script>
</body>
</html>